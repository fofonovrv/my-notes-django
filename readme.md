# Личная шпаргалка по django

### Уроки: https://github.com/selfedu-rus/django-lessons

## Классы, Модели и Базы данных:
### поле для автоматической записи даты и времени создания записи в таблице БД:
```
time_create = models.DateTimeField(auto_now_add=True)
```
### Аргументы поля.
Ссылка на документацию https://docs.djangoproject.com/en/2.2/ref/models/fields/

для обновления записи:
```
auto_now=True
```
для индексации поля (для более быстрого поиска по таблице)
```
db_index = true
```
разрешить оставлять поле без значения:
```
null=True
```
разрешить оставлять значение пустым, для текстовых и строковых полей:
```
blank=True
```
 ## Созданеи записей в БД
 ### "Ленивое" наполнение БД. 
 Создаем экземпляр класса
 ```
 user1 = Users()
 ```
  в разны частях приложения наполняем его
 ```
 user1.name = 'Misha'
 user1.email = 'misha@mail.ru'
 ```
  в нужный нам момент сохраняем, только в этот момент объект класса модели создается в БД как запись
 ```
 user1.save()
 ```
 ### второй вариант. с помощью стандартного метода objects.create() 
 сразу создаем запись в БД и присваиваем ее экземпляру класса
```
user2 = Users.objects.create(name='BorisB', email='borya@mail.ru')
```
 ### или вообще не создавать экземляр класса, а только запись в БД
```
Users.objects.create(name='BorisB', email='borya@mail.ru')
```
## чтение записей из БД
### считать сразу все записи таблицы (если их немного!)
```
Users.objects.all()
```
### чтобы .all() отобразил читабельные названия/имена записей, в моделе должен быть метод str
```
    def __str__(self):
        return self.name
```
### считываем все записи таблицы, помещаем их в список, затем можем обращаться к отдельным полям элементов списка
```
u = Users.objects.all()
print(u[0].name, u[1].name)
```
### используем метод filter для выборки по какому-либо полю (можно несколько условий через запятую). результат выполнение - список объектов класса Users
```
Users.objects.filter(email='borya@mail.ru')
```
### фильтр по именованному параметру pk (primary key, в общем случае == id). например, все записи поместить в u1 с id >=5 и все записи <= 10 поместить в u2
```
u1 = Users.objects.filter(pk__gte=5)
u2 = Users.objects.filter(pk__lte=5)
```
### используем метод exclude  - выбрать все записи кроме тех, что подпадают под усоловие. например, все записи, кроме id=1
```
Users.objects.exclude(pk=1)
```
### если нам нужно получить какую-то определенную запись по какому-либо определенному полю, то лучше использовать метод get. например, получим запись с именем BorisB
```
Users.objects.get(name='BorisB')
```
### !если в результате выполнение get будет получено несколько записей или не будет ни одной записи, то будет сгенерировано исключение!
